#!/bin/bash

export PIO_MODEL_PATH=${PIO_MODEL_STORE_HOME}/${PIO_MODEL_TYPE}/${PIO_MODEL_NAMESPACE}/${PIO_MODEL_NAME}/${PIO_MODEL_VERSION}
<<<<<<< HEAD
export PIO_MODEL_IO_TRANSFORMERS_PATH=${PIO_MODEL_PATH}
=======
>>>>>>> fluxcapacitor/master
export PIO_MODEL_BASE_PATH=${PIO_MODEL_PATH}/..

echo "Activating 'model_environment_python3'"
source activate model_environment_python3
echo ""
echo "Starting Http Grpc Proxy..."
echo ""
echo "PIO_MODEL_STORE_HOME=$PIO_MODEL_STORE_HOME"
echo "PIO_MODEL_NAMESPACE=$PIO_MODEL_NAMESPACE"
echo "PIO_MODEL_NAME=$PIO_MODEL_NAME"
echo "PIO_MODEL_VERSION=$PIO_MODEL_VERSION"
echo "PIO_MODEL_PATH=$PIO_MODEL_PATH"
<<<<<<< HEAD
echo "PIO_MODEL_IO_TRANSFORMERS_PATH=$PIO_MODEL_IO_TRANSFORMERS_PATH"
echo "PIO_MODEL_SERVER_PORT=$PIO_MODEL_SERVER_PORT"
=======
echo "PIO_MODEL_SERVER_PORT=$PIO_MODEL_SERVER_PORT"
echo "PIO_MODEL_SERVER_PROMETHEUS_PORT=$PIO_MODEL_SERVER_PROMETHEUS_PORT"
>>>>>>> fluxcapacitor/master
echo "PIO_MODEL_TENSORFLOW_SERVING_PORT=$PIO_MODEL_TENSORFLOW_SERVING_PORT"
echo "PIO_MODEL_BASE_PATH=$PIO_MODEL_BASE_PATH"

# Args:
#  $1: http port (external-facing)
#  $2: grpc port (internal-facing)
<<<<<<< HEAD
python /root/src/main/python/model/model_server_python3.py $PIO_MODEL_SERVER_PORT $PIO_MODEL_TENSORFLOW_SERVING_PORT
=======
/root/src/main/python/model_server_python3.py --PIO_MODEL_STORE_HOME=$PIO_MODEL_STORE_HOME --PIO_MODEL_TYPE=$PIO_MODEL_TYPE --PIO_MODEL_NAMESPACE=$PIO_MODEL_NAMESPACE --PIO_MODEL_NAME=$PIO_MODEL_NAME --PIO_MODEL_VERSION=$PIO_MODEL_VERSION --PIO_MODEL_SERVER_PORT=$PIO_MODEL_SERVER_PORT --PIO_MODEL_SERVER_PROMETHEUS_PORT=$PIO_MODEL_SERVER_PROMETHEUS_PORT --PIO_MODEL_TENSORFLOW_SERVING_PORT=$PIO_MODEL_TENSORFLOW_SERVING_PORT
>>>>>>> fluxcapacitor/master
